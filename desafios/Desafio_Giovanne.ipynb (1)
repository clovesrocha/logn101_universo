{"cells":[{"cell_type":"code","source":["\n","üß† Desafio T√©cnico ‚Äî Otimizando Algoritmos de Classifica√ß√£o para Previs√£o de Evas√£o (Churn)\n","\n","Disciplina: L√≥gica e Algoritmo 2\n","Tema: Machine Learning com Python\n","Autor: Simula√ß√£o em Colab (Henrique)\n","\n","\n","---\n","\n","üîπ 1. Entendimento do Problema (Defini√ß√£o)\n","\n","O objetivo √© prever se um cliente vai ou n√£o cancelar seu contrato (evas√£o, ou ‚Äúchurn‚Äù).\n","Para isso, treinaremos modelos de Machine Learning que aprendem com dados hist√≥ricos de clientes.\n","\n","\n","---\n","\n","üîπ 2. Coleta e Entendimento dos Dados\n","\n","Simulando um dataset de clientes de uma empresa de telecomunica√ß√µes.\n","\n","# Bibliotecas principais\n","import pandas as pd\n","import numpy as np\n","\n","# Criando dataset simulado\n","dados = pd.DataFrame({\n","    'idade': np.random.randint(18, 70, 1000),\n","    'meses_como_cliente': np.random.randint(1, 72, 1000),\n","    'plano': np.random.choice(['B√°sico', 'Intermedi√°rio', 'Premium'], 1000),\n","    'pagamento_em_dia': np.random.choice([0, 1], 1000),\n","    'suporte_reclamacoes': np.random.randint(0, 10, 1000),\n","    'valor_mensal': np.random.uniform(50, 300, 1000),\n","    'churn': np.random.choice([0, 1], 1000, p=[0.75, 0.25]) # 0 = Fiel, 1 = Evadiu\n","})\n","\n","# Mostrando as 10 primeiras linhas\n","dados.head(10)\n","\n","\n","---\n","\n","üîπ 3. Tratamento/Pr√©-processamento dos Dados\n","\n","Objetivo: preparar os dados para o modelo.\n","\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.model_selection import train_test_split\n","\n","# Convertendo vari√°veis categ√≥ricas\n","encoder = LabelEncoder()\n","dados['plano'] = encoder.fit_transform(dados['plano'])\n","\n","# Separando features (X) e r√≥tulo (y)\n","X = dados.drop('churn', axis=1)\n","y = dados['churn']\n","\n","# Divis√£o treino e teste\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","X_train.shape, X_test.shape\n","\n","üìò Explica√ß√£o:\n","\n","As colunas categ√≥ricas foram convertidas em n√∫meros com LabelEncoder.\n","\n","Dividimos os dados para avaliar o modelo em dados nunca vistos.\n","\n","\n","\n","---\n","\n","üîπ 4. An√°lise Explorat√≥ria (Resumida)\n","\n","Vamos analisar brevemente o equil√≠brio entre classes.\n","\n","y.value_counts(normalize=True)\n","\n","üìò Se houver muito mais 0s do que 1s, temos desbalanceamento de classes, o que afeta modelos.\n","\n","\n","---\n","\n","üîπ 5. Modelagem de Algoritmos (Treinamento)\n","\n","Vamos testar tr√™s classificadores comuns:\n","\n","Regress√£o Log√≠stica\n","\n","√Årvore de Decis√£o\n","\n","Random Forest\n","\n","\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.tree import DecisionTreeClassifier\n","from sklearn.ensemble import RandomForestClassifier\n","\n","modelos = {\n","    'Regress√£o Log√≠stica': LogisticRegression(max_iter=500),\n","    '√Årvore de Decis√£o': DecisionTreeClassifier(max_depth=5),\n","    'Random Forest': RandomForestClassifier(n_estimators=100)\n","}\n","\n","for nome, modelo in modelos.items():\n","    modelo.fit(X_train, y_train)\n","    score = modelo.score(X_test, y_test)\n","    print(f\"{nome}: Acur√°cia = {score:.2f}\")\n","\n","\n","---\n","\n","üîπ 6. Avalia√ß√£o dos Modelos\n","\n","Vamos usar Accuracy, Precision, Recall e F1-Score.\n","\n","from sklearn.metrics import classification_report\n","\n","melhor_modelo = RandomForestClassifier(n_estimators=100)\n","melhor_modelo.fit(X_train, y_train)\n","y_pred = melhor_modelo.predict(X_test)\n","\n","print(classification_report(y_test, y_pred))\n","\n","üìò Explica√ß√£o:\n","\n","A Random Forest costuma ter melhor desempenho, pois combina v√°rias √°rvores de decis√£o.\n","\n","O F1-score equilibra precis√£o e sensibilidade, ideal para problemas desbalanceados.\n","\n","\n","\n","---\n","\n","üîπ 7. Deploy (Simula√ß√£o de Fun√ß√£o)\n","\n","Fun√ß√£o para prever se um novo cliente tem risco de churn.\n","\n","def prever_novo_cliente(dados_cliente):\n","    \"\"\"\n","    dados_cliente: dicion√°rio com as informa√ß√µes do cliente\n","    retorna: probabilidade de churn e decis√£o (Sim/N√£o)\n","    \"\"\"\n","    df_cliente = pd.DataFrame([dados_cliente])\n","    df_cliente['plano'] = encoder.transform(df_cliente['plano'])\n","\n","    prob = melhor_modelo.predict_proba(df_cliente)[0][1]\n","    decisao = \"Evadir (Churn)\" if prob > 0.5 else \"Fiel (N√£o Churn)\"\n","\n","    return {\n","        'Probabilidade de Evas√£o (%)': round(prob * 100, 2),\n","        'Decis√£o': decisao\n","    }\n","\n","# Exemplo de uso\n","novo = {\n","    'idade': 30,\n","    'meses_como_cliente': 12,\n","    'plano': 'Intermedi√°rio',\n","    'pagamento_em_dia': 1,\n","    'suporte_reclamacoes': 2,\n","    'valor_mensal': 150\n","}\n","\n","prever_novo_cliente(novo)\n","\n","\n","---\n","\n","üîπ 8. Relat√≥rio Explicativo\n","\n","üìÑ Resumo das Etapas e Decis√µes:\n","\n","Etapa   Decis√£o Justificativa\n","\n","Pr√©-processamento   LabelEncoder + divis√£o treino/teste Necess√°rio para o modelo entender vari√°veis categ√≥ricas\n","Modelagem   Teste com 3 modelos (Regress√£o Log√≠stica, √Årvore, Random Forest)    Comparar desempenho e escolher o mais robusto\n","Avalia√ß√£o   F1-score e Recall como m√©tricas principais  Focam na capacidade de detectar evas√£o real\n","Melhor modelo   Random Forest   Maior equil√≠brio entre precis√£o e sensibilidade\n","Deploy  Fun√ß√£o prever_novo_cliente()    Simula uso real do modelo em produ√ß√£o\n","\n","\n","\n","---\n","\n","‚úÖ Conclus√£o\n","\n","O modelo de Random Forest apresentou o melhor desempenho para prever evas√£o de clientes.\n","O pipeline completo pode ser facilmente adaptado para datasets reais.\n","O uso de m√©tricas como o F1-score √© essencial para problemas desbalanceados como o churn."],"metadata":{"id":"Jssp58FeEQvP"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyPzvbJkgq7YyFyx9auQWETE"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}